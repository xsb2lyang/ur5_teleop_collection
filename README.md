
#  UR5 æœºå™¨äººé¥æ“ä½œä¸å¤šæ¨¡æ€æ•°æ®é‡‡é›†å¹³å° - ç”¨æˆ·æ‰‹å†Œ

## **1. ç®€ä»‹**

æœ¬é¡¹ç›®æä¾›äº†ä¸€å¥—å®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼Œç”¨äºé€šè¿‡Xboxæ‰‹æŸ„å®æ—¶é¥æ“ä½œUR5/UR5eæœºæ¢°è‡‚ï¼Œå¹¶åŒæ­¥é‡‡é›†å¤šæ¨¡æ€ã€å¤šè§†è§’çš„æ•°æ®ã€‚å¹³å°ä¸“ä¸ºæœºå™¨äººå­¦ä¹ é¢†åŸŸçš„æ•°æ®é›†é‡‡é›†è€Œè®¾è®¡ï¼Œæ”¯æŒåœ¨ç¨‹åºå¯åŠ¨æ—¶å®šä¹‰**ä»»åŠ¡æŒ‡ä»¤**å’Œ**é‡‡é›†é¢‘ç‡**ï¼Œå¹¶ç”¨â€œå¼€å§‹-åœæ­¢â€çš„æ¨¡å¼å¾ªç¯é‡‡é›†åŒä¸€ä»»åŠ¡çš„å¤šä¸ªæ ·æœ¬ï¼Œæœ€ç»ˆä»¥ç»“æ„åŒ–çš„ã€å¯¹æœºå™¨å­¦ä¹ å‹å¥½çš„æ ¼å¼è¿›è¡Œä¿å­˜ã€‚

## **âœ¨ ä¸»è¦åŠŸèƒ½**

  - **äº¤äº’å¼ä»»åŠ¡å®šä¹‰**:
      - åœ¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œé€šè¿‡ç»ˆç«¯è¾“å…¥**è‡ªç„¶è¯­è¨€æŒ‡ä»¤**æ¥å®šä¹‰å½“å‰æ‰¹æ¬¡çš„é‡‡é›†ä»»åŠ¡ã€‚
      - æ”¯æŒ**è‡ªå®šä¹‰æ•°æ®é‡‡é›†é¢‘ç‡**ï¼Œçµæ´»é€‚é…ä¸åŒä»»åŠ¡çš„éœ€æ±‚ã€‚
  - **å®æ—¶é¥æ“ä½œ**:
      - é€šè¿‡Xboxæ‰‹æŸ„è¿›è¡Œä½å»¶è¿Ÿã€ç›´è§‚çš„6è‡ªç”±åº¦è¿åŠ¨æ§åˆ¶ã€‚
  - **åŒæ¨¡æ€æœºå™¨äººæ•°æ®è®°å½•**:
      - åŒæ­¥è®°å½•ä¸¤ç§æ ¸å¿ƒæœºå™¨äººæ•°æ®ï¼Œä¸ºä¸åŒçš„å­¦ä¹ ç®—æ³•æä¾›æ”¯æŒï¼š
          - **åŠ¨ä½œ (Action)**: 7è‡ªç”±åº¦çš„**ç›¸å¯¹ä½å§¿å˜åŒ–**æŒ‡ä»¤ `(Î”X, Î”Y, Î”Z, Î”Rx, Î”Ry, Î”Rz, Gripper)`ã€‚
          - **çŠ¶æ€ (State/Proprioception)**: 7è‡ªç”±åº¦çš„**ç»å¯¹TCPä½å§¿**å’Œå¤¹çˆªçŠ¶æ€ã€‚
  - **å¤šè§†è§’å›¾åƒåŒæ­¥**:
      - åŒæ­¥è®°å½•æ¥è‡ªå¤šä¸ªå¼‚æ„ç›¸æœºï¼ˆIntel RealSense D435, Stereolabs ZED 2iï¼‰çš„RGBåŠæ·±åº¦å›¾åƒã€‚
  - **ç»“æ„åŒ–çš„æ•°æ®è¾“å‡º**:
      - æ•°æ®è‡ªåŠ¨æŒ‰**ä»»åŠ¡æŒ‡ä»¤**è¿›è¡Œæ–‡ä»¶å¤¹å½’ç±»ã€‚
      - æ¯ä¸ªé‡‡é›†æ ·æœ¬ï¼ˆsessionï¼‰éƒ½åŒ…å«ç‹¬ç«‹çš„ `language.txt`, `robot_action.npy`, `robot_state.npy` å’Œå›¾åƒæ–‡ä»¶å¤¹ã€‚

## **ğŸ› ï¸ ç¯å¢ƒä¾èµ–**

### **ç¡¬ä»¶ (Hardware)**

  - UR5 æˆ– UR5e æœºæ¢°è‡‚
  - Robotiq 2F-85 äºŒæŒ‡å¤¹çˆª
  - æ ‡å‡† Xbox æ§åˆ¶å™¨
  - Intel RealSense D435 æ·±åº¦ç›¸æœº
  - Stereolabs ZED 2i æ·±åº¦ç›¸æœº
  - ä¸€å°è¿æ¥ä»¥ä¸Šæ‰€æœ‰è®¾å¤‡çš„Linuxå·¥ä½œç«™ï¼ˆæœ¬äººé‡‡ç”¨Ubuntu 22.04ï¼‰

### **è½¯ä»¶ (Software)**

- Python (>= 3.8)
- **ZED SDK**: è¯·ä» [Stereolabså®˜ç½‘](https://www.stereolabs.com/developers/release/) ä¸‹è½½å¹¶å®‰è£…ã€‚
- **Python ä¾èµ–åº“**:
  åˆ›å»ºä¸€ä¸ªåä¸º `requirements.txt` çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œç„¶åé€šè¿‡ `pip install -r requirements.txt` å®‰è£…ã€‚

  ```txt
  ur-rtde
  inputs
  pyrealsense2
  pyzed
  numpy
  opencv-python
  psutil
  ```


## **ğŸš€ å®‰è£…ä¸é…ç½®**

1.  **å…‹éš†é¡¹ç›®**
    ```bash
    git clone [æ‚¨çš„é¡¹ç›®ä»“åº“åœ°å€]
    cd [é¡¹ç›®æ–‡ä»¶å¤¹]
    ```

2.  **å®‰è£…ZED SDK**
    è¯·åŠ¡å¿…å…ˆå®‰è£…ä¸æ‚¨CUDAç‰ˆæœ¬åŒ¹é…çš„ZED SDKï¼Œå¹¶æ ¹æ®æŒ‡å¼•å®ŒæˆPython APIçš„å®‰è£…ã€‚

3.  **é…ç½®æœºå™¨äººIPåœ°å€ (é‡è¦!)**
    æ‰“å¼€ `src/ur5_control/ur5_controller.py` æ–‡ä»¶ï¼Œä¿®æ”¹ `UR5Controller` åˆå§‹åŒ–æ—¶çš„ `robot_ip` å‚æ•°ä¸ºæ‚¨æœºæ¢°è‡‚çš„å®é™…IPåœ°å€ã€‚
    ```python
    # line 27 in ur5_controller.py
    def __init__(self, robot_ip="192.168.192.7", ...): # <-- ä¿®æ”¹æ­¤å¤„çš„IPåœ°å€
    ```

4.  **å®‰è£…Pythonä¾èµ–**
    ```bash
    pip install -r requirements.txt
    ```

## **â–¶ï¸ è¿è¡Œç¨‹åº**

ç¡®ä¿æ‰€æœ‰ç¡¬ä»¶å·²è¿æ¥å¹¶ä¸Šç”µã€‚è¿›å…¥ `src` ç›®å½•ï¼Œåœ¨ç»ˆç«¯ä¸­è¿è¡Œä¸»ç¨‹åºã€‚æ¨èä½¿ç”¨ `sudo` ä»¥ç¡®ä¿ç¨‹åºæœ‰è¶³å¤Ÿçš„æƒé™è®¾ç½®å®æ—¶ç³»ç»Ÿä¼˜å…ˆçº§ã€‚

```bash
cd src
sudo $(which python) main.py
```

## **ğŸ“‹ é‡‡é›†æµç¨‹**

1.  **å¯åŠ¨å¹¶è¾“å…¥å‚æ•°**:

      * ç¨‹åºå¯åŠ¨åï¼Œç»ˆç«¯ä¼šæç¤º `(1/2) è¯·è¾“å…¥å½“å‰ä»»åŠ¡çš„è¯­è¨€æŒ‡ä»¤...`ã€‚è¯·è¾“å…¥æœ¬æ¬¡è¦é‡‡é›†çš„æ‰€æœ‰æ ·æœ¬çš„å…±åŒä»»åŠ¡æè¿°ï¼ˆä¾‹å¦‚ `pick up the red block`ï¼‰ï¼Œç„¶åæŒ‰å›è½¦ã€‚
      * æ¥ç€ï¼Œç»ˆç«¯ä¼šæç¤º `(2/2) è¯·è¾“å…¥æ•°æ®é‡‡é›†é¢‘ç‡...`ã€‚è¯·è¾“å…¥æ‚¨æœŸæœ›çš„é‡‡é›†é¢‘ç‡ï¼ˆå•ä½Hzï¼Œä¾‹å¦‚ `10`ï¼‰ï¼Œç„¶åæŒ‰å›è½¦ã€‚

2.  **ä»»åŠ¡å‡†å¤‡**:

      * ç¨‹åºåˆå§‹åŒ–å®Œæˆåï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ‰‹æŸ„è‡ªç”±ç§»åŠ¨æœºæ¢°è‡‚åˆ°åˆé€‚çš„èµ·å§‹ä½ç½®ã€‚

3.  **å¼€å§‹å½•åˆ¶**:

      * å½“ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œ**æŒ‰ä¸€ä¸‹æ‰‹æŸ„ä¸Šçš„ `Start` é”®**ã€‚ç»ˆç«¯ä¼šæç¤ºâ€œå½•åˆ¶å¼€å§‹...â€ï¼Œç¨‹åºä¼šæ ¹æ®æ‚¨è®¾å®šçš„é¢‘ç‡åœ¨åå°å¼€å§‹è®°å½•æ‰€æœ‰æ•°æ®æµã€‚

4.  **æ‰§è¡Œä»»åŠ¡**:

      * åœ¨å½•åˆ¶çŠ¶æ€ä¸‹ï¼Œä½¿ç”¨æ‰‹æŸ„é¥æ“ä½œæœºæ¢°è‡‚å’Œå¤¹çˆªï¼Œå®Œæˆä¸€ä¸ªå®Œæ•´çš„æ“ä½œä»»åŠ¡ã€‚

5.  **ç»“æŸå¹¶ä¿å­˜**:

      * ä»»åŠ¡å®Œæˆåï¼Œ**æŒ‰ä¸€ä¸‹æ‰‹æŸ„ä¸Šçš„ `Back` é”®**ã€‚å½•åˆ¶ä¼šç«‹å³åœæ­¢ï¼Œç¨‹åºä¼šè‡ªåŠ¨å¤„ç†å¹¶ä¿å­˜è¿™æ®µæ—¶é—´é‡‡é›†åˆ°çš„æ‰€æœ‰æ•°æ®ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ `session` æ–‡ä»¶å¤¹ã€‚

6.  **é‡å¤æˆ–é‡‡é›†æ–°ä»»åŠ¡**:

      * **é‡å¤é‡‡é›†**: æ‚¨å¯ä»¥é‡å¤ç¬¬2æ­¥è‡³ç¬¬5æ­¥ï¼Œä¸º**åŒä¸€ä¸ªä»»åŠ¡**ï¼ˆç”±å¯åŠ¨æ—¶è¾“å…¥çš„æŒ‡ä»¤å†³å®šï¼‰é‡‡é›†å¤šä¸ªä¸åŒçš„æ ·æœ¬ã€‚
      * **é‡‡é›†æ–°ä»»åŠ¡**: å¦‚æœæ‚¨æƒ³é‡‡é›†ä¸€ä¸ª**ä¸åŒ**çš„ä»»åŠ¡ï¼Œè¯·æŒ‰ `Ctrl+C` é€€å‡ºå½“å‰ç¨‹åºï¼Œç„¶åé‡æ–°è¿è¡Œ `main.py` å¹¶è¾“å…¥æ–°çš„è¯­è¨€æŒ‡ä»¤ã€‚

## **ğŸ® æ“ä½œæŒ‡å—**
![Xbox æ§åˆ¶å™¨æ“ä½œç¤ºæ„å›¾](./assets/xbox.jpg)

| æ§åˆ¶åŠŸèƒ½ | æŒ‰é”® / æ‘‡æ† |
| :--- | :--- |
| **è¿åŠ¨æ§åˆ¶** | |
| å‰å / å·¦å³ç§»åŠ¨ | `å·¦æ‘‡æ†` |
| ä¸Šä¸‹ç§»åŠ¨ | `å³æ‰³æœº (RT)` / `å·¦æ‰³æœº (LT)` |
| å·¥å…·å§¿æ€æ—‹è½¬ (Roll/Pitch) | `å³æ‘‡æ†` |
| å·¥å…·å§¿æ€æ—‹è½¬ (Yaw) | `å³è‚©é”® (RB)` / `å·¦è‚©é”® (LB)` |
| **å¤¹çˆªæ§åˆ¶** | |
| å¼ å¼€å¤¹çˆª | `Y` é”® |
| é—­åˆå¤¹çˆª | `X` é”® |
| **ç¨‹åºæ§åˆ¶** | |
| æš‚åœ/æ¢å¤æœºå™¨äººè¿åŠ¨ | `A` é”® / `B` é”® |
| **å¼€å§‹** æ•°æ®å½•åˆ¶ | `Start` é”® |
| **ç»“æŸ** å¹¶ **ä¿å­˜** æ•°æ® | `Back` é”® |
| å®‰å…¨é€€å‡ºç¨‹åº | åœ¨ç»ˆç«¯æŒ‰ `Ctrl + C` |

## **ğŸ“ è¾“å‡ºæ•°æ®ç»“æ„**

æ‰€æœ‰æ•°æ®éƒ½ä¿å­˜åœ¨ `robot_dataset` æ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶æŒ‰ä»»åŠ¡æŒ‡ä»¤è¿›è¡Œå½’ç±»ã€‚

```
robot_dataset/
â””â”€â”€ pick_up_the_red_block_demo/  <-- ä»¥â€œæŒ‡ä»¤_demoâ€å‘½åçš„ä»»åŠ¡æ–‡ä»¶å¤¹
    â”œâ”€â”€ demo_0/                 <-- ç¬¬ä¸€ä¸ªæ ·æœ¬ (Trajectory 0)
    â”‚   â”œâ”€â”€ image0/             <-- ç¬¬ä¸‰æ–¹ç§°è§†è§’ (zed_color)
    â”‚   â”œâ”€â”€ image1/             <-- ç¬¬ä¸€äººç§°è§†è§’ (d435_color)
    â”‚   â”œâ”€â”€ image3/             <-- æ·±åº¦å›¾ (d435_depth)
    â”‚   â”œâ”€â”€ action.npy
    â”‚   â”œâ”€â”€ state.npy
    â”‚   â””â”€â”€ lang.txt
    â”‚
    â””â”€â”€ demo_1/                 <-- ç¬¬äºŒä¸ªæ ·æœ¬ (Trajectory 1)
        â””â”€â”€ ... (å†…éƒ¨ç»“æ„åŒä¸Š)

```

## **ğŸ“Š è¾“å‡ºæ•°æ®æ ¼å¼è¯¦è§£ (æ›´æ–°ç‰ˆ)**

æ¯ä¸ª `demo_X` æ–‡ä»¶å¤¹éƒ½åŒ…å«ä¸€ä¸ªå®Œæ•´çš„ã€å¤šæ¨¡æ€çš„ä»»åŠ¡æ ·æœ¬ã€‚

- **`lang.txt`**
    
    - **å†…å®¹**: çº¯æ–‡æœ¬æ–‡ä»¶ï¼Œè®°å½•äº†æœ¬æ¬¡ä»»åŠ¡çš„è‡ªç„¶è¯­è¨€æŒ‡ä»¤ã€‚
        
- **`action.npy`**
    
    - **æ ¼å¼**: NumPyæ•°ç»„ï¼Œç»´åº¦ä¸º `(N, 7)`ï¼Œå…¶ä¸­ `N` æ˜¯æ€»å¸§æ•°ã€‚
        
    - **å†…å®¹**: **åŠ¨ä½œ (Action)** æ•°æ®ã€‚æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªæ—¶é—´æ­¥å‘é€ç»™æœºå™¨äººçš„**ç›¸å¯¹ä½å§¿å˜åŒ–**æŒ‡ä»¤ï¼Œ7ä¸ªç»´åº¦çš„å«ä¹‰æ˜¯ `[Î”X, Î”Y, Î”Z, Î”Rx, Î”Ry, Î”Rz, Gripper]`ã€‚
        
- **`state.npy`**
    
    - **æ ¼å¼**: NumPyæ•°ç»„ï¼Œç»´åº¦ä¸º `(N, 7)`ã€‚
        
    - **å†…å®¹**: **çŠ¶æ€ (State/Proprioception)** æ•°æ®ã€‚æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªæ—¶é—´æ­¥ä»æœºå™¨äººè¯»å›çš„**ç»å¯¹TCPä½å§¿**å’Œå¤¹çˆªçŠ¶æ€ï¼Œ7ä¸ªç»´åº¦çš„å«ä¹‰æ˜¯ `[X, Y, Z, Rx, Ry, Rz, Gripper]`ã€‚
        
- **å›¾åƒæ–‡ä»¶å¤¹**
    
    - **å†…å®¹**: `image0/`, `image1/`, `image3/` æ–‡ä»¶å¤¹å†…å­˜æ”¾ç€å¯¹åº”æ•°æ®æµçš„å›¾åƒæ–‡ä»¶ã€‚
        
        - `image0`: **ç¬¬ä¸‰æ–¹ç§°è§†è§’** (æ¥è‡ª ZED ç›¸æœº)
            
        - `image1`: **ç¬¬ä¸€äººç§°è§†è§’** (æ¥è‡ª RealSense D435 å½©è‰²ç›¸æœº)
            
        - `image3`: **æ·±åº¦å›¾** (æ¥è‡ª RealSense D435 æ·±åº¦ç›¸æœº)
            
    - **å‘½å**: ã€**é‡è¦æ›´æ–°**ã€‘æ–‡ä»¶åç°åœ¨æ˜¯**ä»0å¼€å§‹çš„æ•´æ•°åºåˆ—**ï¼ˆå¦‚ `0.png`, `1.png`, `2.png`...ï¼‰ï¼Œä¸å†ä½¿ç”¨æ—¶é—´æˆ³ã€‚è¿™ä¸æ ‡å‡†çš„æœºå™¨å­¦ä¹ æ•°æ®é›†æ ¼å¼å®Œå…¨å¯¹é½ï¼Œä¾¿äºæ•°æ®åŠ è½½å™¨æŒ‰ç´¢å¼•è¯»å–ã€‚
        
    - **æ ¼å¼**: å½©è‰²å›¾ä¿å­˜ä¸º `.jpg`ï¼Œæ·±åº¦å›¾ä¸ºä¿ç•™å®Œæ•´ç²¾åº¦ä¿å­˜ä¸º `.png`ã€‚
        


## **ğŸ“ æ³¨æ„äº‹é¡¹**

  - **æ·±åº¦å›¾æŸ¥çœ‹**ï¼šä¿å­˜çš„ `d435_depth` å›¾åƒæ˜¯16ä½çš„åŸå§‹æ·±åº¦æ•°æ®ï¼Œè¯·åœ¨Pythonè„šæœ¬ä¸­ä½¿ç”¨ `cv2.imread(path, cv2.IMREAD_UNCHANGED)` æ¥è¯»å–ã€‚
  - **ç¨‹åºé€€å‡º**ï¼šå¦‚æœåœ¨å½•åˆ¶è¿‡ç¨‹ä¸­ä½¿ç”¨ `Ctrl+C` å¼ºè¡Œé€€å‡ºç¨‹åºï¼Œç¨‹åºä¼šå°è¯•è‡ªåŠ¨ä¿å­˜å½“å‰å·²é‡‡é›†çš„æ•°æ®ã€‚
